<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>영원의 집 | REDOOR 5TH</title>

<style>
:root{
  --bg:#000;
  --fg:#fff;
  --muted:rgba(255,255,255,.6);
  --line:rgba(255,255,255,.18);
  --radius:12px;
  --max:900px;
}
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  background:var(--bg);
  color:var(--fg);
  font-family:-apple-system,BlinkMacSystemFont,"Noto Sans KR",system-ui,sans-serif;
  line-height:1.6;
}

a{color:var(--fg);text-decoration:none}
a:hover{ text-decoration: underline; text-underline-offset: 3px; }

.container{
  width:min(var(--max),calc(100% - 32px));
  margin:0 auto;
}

h1{font-size:38px;letter-spacing:.12em;margin:0}
h2{font-size:22px;letter-spacing:.08em;margin:0}
p{margin:0}
@media(max-width:640px){
  h1{font-size:34px;}
}

/* Views */
.view{ display:none; min-height: calc(100vh - 24px); }
.view.is-active{ display:block; }

/* HARD GUARANTEE: once gate opens, entrance is hidden */
body.gate-open #view-entrance{ display:none !important; }

/* Fade transition helper */
.fade{ opacity:0; transform: translateY(6px); transition: opacity .25s ease, transform .25s ease; }
.view.is-active .fade{ opacity:1; transform: translateY(0); }

/* Flash overlay (for gate transition) */
.flash{
  position:fixed;
  inset:0;
  background:#000;
  opacity:0;
  pointer-events:none;
  z-index:999;
  transition: opacity .12s linear;
}
.flash.is-on{ opacity:1; }

/* Entrance hero */
.hero{
  display:flex;
  flex-direction:column;
  align-items:center;
  gap:26px;
  margin: 0 auto;
}

.hero-copy{
  display:flex;
  flex-direction:column;
  gap:10px;
  align-items:center;
}

.hero-q{
  font-size: 14px;
  letter-spacing: .06em;
  color: var(--muted);
  text-align:center;
}

.hero-sub{
  font-size: 13px;
  letter-spacing: .08em;
  color: var(--fg);
  opacity:.9;
}

.divider{
  width: 160px;
  height: 1px;
  background: var(--line);
  margin-top: 10px;
}

/* Gate */
.entrance{ padding-top: 0; text-align:center; }
.gate-wrap{
  margin-top: 120px;
  display:flex;
  justify-content:center;
}
.gate-frame{
  width: 200px;
  height: 320px;
  border:1px solid var(--line);
  display:flex;
  align-items:flex-end;
  justify-content:center;
  position: relative;
}

/* Door */
.gate-door{
  width: 160px;
  height: 260px;
  margin-bottom: 20px;
  background: var(--fg);
  cursor:pointer;
  position: relative;
  transform-origin: left center;
  transition: transform .6s ease;
}
.gate-door:hover{
  transform: perspective(900px) rotateY(-6deg);
}
body.gate-open .gate-door{
  transform: perspective(900px) rotateY(-72deg);
}

/* Handle */
.gate-handle{
  position:absolute;
  right: 22px;
  top: 50%;
  width: 10px;
  height: 10px;
  border: 2px solid rgba(0,0,0,.85);
  border-radius: 50%;
  transform: translateY(-50%);
}

/* Light glow from the gap */
.gate-glow{
  position:absolute;
  left: -2px;
  top: 0;
  bottom: 0;
  width: 6px;
  background: linear-gradient(to right,
    rgba(255,255,255,0.55),
    rgba(255,255,255,0.0)
  );
  opacity: 0.15;
  transition: opacity .4s ease, width .6s ease;
}
body.gate-open .gate-glow{
  opacity: 0.9;
  width: 22px;
}

/* Hall */
.hall{
  padding-top: 120px;
  text-align:center;
}
.hall-title{
  margin-top: 18px;
  font-size: 12px;
  letter-spacing:.10em;
  color: var(--muted);
}

/* Reuse door card */
.door{
  border:1px solid var(--line);
  padding:28px 20px;
  cursor:pointer;
  transition:.2s;
  border-radius: var(--radius);
}
.door:hover{ transform:translateY(-3px); border-color:var(--fg); }
.door span{display:block}
.door .num{ font-size:12px; color:var(--muted); letter-spacing:.12em; }
.door .label{ font-size:18px; margin-top:6px; }

.door-row{
  margin-top: 34px;
  display:grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 14px;
}
@media(max-width:860px){
  .door-row{ grid-template-columns: repeat(2, 1fr); }
}

/* Rooms */
.room{ padding-top: 110px; }
.room-head{ margin-bottom: 24px; display:flex; justify-content:space-between; align-items:baseline; gap: 12px; }
.hint{ font-size:12px; color: var(--muted); }

.info-grid{ display:grid; grid-template-columns:repeat(2,1fr); gap:24px; }
@media(max-width:640px){ .info-grid{grid-template-columns:1fr} }
.block h3{ font-size:12px; letter-spacing:.1em; margin:0 0 6px; }
.block p{ color:var(--muted) }
.note{ margin-top:32px; padding-top:24px; border-top:1px solid var(--line); color:var(--muted); }

.accordion button{ width:100%; background:none; border:1px solid var(--line); color:var(--fg); padding:16px; text-align:left; cursor:pointer; border-radius: var(--radius); }
.accordion button + div{ display:none; padding:16px; border:1px solid var(--line); border-top:none; color:var(--muted); border-radius: 0 0 var(--radius) var(--radius); margin-bottom: 10px; }

footer{
  padding:48px 0 96px;
  border-top:1px solid var(--line);
  text-align:center;
  color:var(--muted);
}

/* Corridor */
.corridor{
  position:fixed;
  left:0;right:0;bottom:0;
  background: var(--bg);
  border-top:1px solid var(--line);
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:12px 16px;
}
.corridor button{
  background:none;
  border:1px solid var(--line);
  color: var(--fg);
  width:44px;height:44px;
  border-radius:50%;
  cursor:pointer;
}
.corridor .where{
  font-size:12px;
  color:var(--muted);
  letter-spacing:.08em;
}
</style>
</head>

<body>
<div class="flash" id="flash" aria-hidden="true"></div>

<div class="container">

  <!-- VIEW: Entrance (gate) -->
  <main class="view is-active" id="view-entrance" data-view>
    <section class="entrance" aria-label="영원의 집 입구">
      <div class="hero fade">
        <div class="gate-wrap">
          <div class="gate-frame">
            <div class="gate-door" id="gateDoor" role="button" tabindex="0" aria-label="대문 열기">
              <div class="gate-handle"></div>
              <div class="gate-glow"></div>
            </div>
          </div>
        </div>

        <div class="hero-copy">
          <div class="hero-q">영원의 집으로 들어가시겠습니까?</div>
          <div class="hero-sub">문을 열어주세요.</div>
          <div class="divider" aria-hidden="true"></div>
        </div>
      </div>
    </section>
  </main>

  <!-- VIEW: Hall (4 doors in a row) -->
  <main class="view" id="view-hall" data-view>
    <section class="hall" aria-label="복도">
      <div class="fade">
        <h1 style="font-size:22px; letter-spacing:.12em;">영원의 집</h1>
        <div class="hall-title">네 개의 문이 나란히 서 있습니다.</div>

        <div class="door-row" aria-label="문 선택">
          <div class="door" role="button" tabindex="0" data-route="#/info">
            <span class="num">문 01</span>
            <span class="label">전시 안내</span>
          </div>
          <div class="door" role="button" tabindex="0" data-route="#/program">
            <span class="num">문 02</span>
            <span class="label">프로그램</span>
          </div>
          <div class="door" role="button" tabindex="0" data-route="#/perks">
            <span class="num">문 03</span>
            <span class="label">특전</span>
          </div>
          <div class="door" role="button" tabindex="0" data-route="#/faq">
            <span class="num">문 04</span>
            <span class="label">FAQ</span>
          </div>
        </div>
      </div>
    </section>
  </main>

  <!-- VIEW: Room - Info -->
  <main class="view" id="view-info" data-view>
    <section class="room" aria-label="전시 안내">
      <div class="fade">
        <div class="room-head">
          <h2>전시 안내</h2>
          <p class="hint">문은 열리면, 먼저 시간을 알려준다.</p>
        </div>

        <div class="info-grid">
          <div class="block">
            <h3>기간</h3>
            <p>YYYY.MM.DD – YYYY.MM.DD</p>
          </div>
          <div class="block">
            <h3>운영 시간</h3>
            <p>12:00 – 20:00</p>
          </div>
          <div class="block">
            <h3>장소</h3>
            <p>서울 ○○구 ○○로 ○○</p>
          </div>
          <div class="block">
            <h3>오시는 길</h3>
            <p>○○역 도보 ○분</p>
          </div>
        </div>

        <p class="note">
          이 공간은 노래가 지나간 자리와<br>
          사라진 감정의 흔적을 잠시 머물게 하는 집입니다.
        </p>
      </div>
    </section>
  </main>

  <!-- VIEW: Room - Program -->
  <main class="view" id="view-program" data-view>
    <section class="room" aria-label="프로그램">
      <div class="fade">
        <div class="room-head">
          <h2>프로그램</h2>
          <p class="hint">가진 시간만큼, 열 수 있는 방이 달라진다.</p>
        </div>

        <div class="accordion">
          <button onclick="toggle(this)">10분의 방</button>
          <div>공간 둘러보기 · 기록 읽기</div>

          <button onclick="toggle(this)">30분의 방</button>
          <div>참여 프로그램 · 음료 특전</div>

          <button onclick="toggle(this)">오래 머무는 방</button>
          <div>심화 체험 · 반복 관람</div>
        </div>
      </div>
    </section>
  </main>

  <!-- VIEW: Room - Perks -->
  <main class="view" id="view-perks" data-view>
    <section class="room" aria-label="특전">
      <div class="fade">
        <h2>특전</h2>
        <p class="lead" style="margin-top:12px; color: var(--muted);">서랍은 천천히 열릴수록 선명하다.</p>
      </div>
    </section>
  </main>

  <!-- VIEW: Room - FAQ -->
  <main class="view" id="view-faq" data-view>
    <section class="room" aria-label="FAQ">
      <div class="fade">
        <h2>FAQ</h2>
        <p class="lead" style="margin-top:12px; color: var(--muted);">누군가의 질문이, 다음 사람의 문이 된다.</p>
      </div>
    </section>
  </main>

  <footer>
    © REDOOR 5TH — House of Eternity
  </footer>

</div>

<div class="corridor" aria-label="복도 네비게이션">
  <button id="backBtn" type="button" aria-label="뒤로">←</button>
  <div class="where" id="where">영원의 집</div>
  <button id="forwardBtn" type="button" aria-label="앞으로">→</button>
</div>

<script>
function toggle(btn){
  const panel = btn.nextElementSibling;
  panel.style.display = panel.style.display === 'block' ? 'none' : 'block';
}

const views = {
  entrance: document.getElementById('view-entrance'),
  hall: document.getElementById('view-hall'),
  info: document.getElementById('view-info'),
  program: document.getElementById('view-program'),
  perks: document.getElementById('view-perks'),
  faq: document.getElementById('view-faq'),
};

const flash = document.getElementById('flash');
const whereEl = document.getElementById('where');
const backBtn = document.getElementById('backBtn');
const forwardBtn = document.getElementById('forwardBtn');

function setActive(name){
  Object.values(views).forEach(v => v?.classList.remove('is-active'));
  views[name]?.classList.add('is-active');
  if(whereEl){
    const map = { entrance:'입구', hall:'복도', info:'전시 안내', program:'프로그램', perks:'특전', faq:'FAQ' };
    whereEl.textContent = map[name] ?? '영원의 집';
  }
}

function routeFromHash(hash){
  const h = (hash ?? location.hash) || '#/';
  if(h === '#/' || h === '#') return 'entrance';
  if(h === '#/hall') return 'hall';
  if(h === '#/info') return 'info';
  if(h === '#/program') return 'program';
  if(h === '#/perks') return 'perks';
  if(h === '#/faq') return 'faq';
  return 'entrance';
}

// Using hash assignment creates a history entry reliably (works in sandbox / GitHub Pages)
function goto(hash){
  if(location.hash === hash){
    setActive(routeFromHash(hash));
    window.scrollTo({top:0, behavior:'auto'});
    return;
  }
  location.hash = hash;
}

function onRouteChange(){
  const viewName = routeFromHash();
  setActive(viewName);
  window.scrollTo({top:0, behavior:'auto'});
}

// Gate open: mobile Chrome / iOS Safari hard-safe
(function(){
  const gateDoor = document.getElementById('gateDoor');
  if(!gateDoor) return;

  let opened = false;

  function openGate(){
    if(opened) return;
    opened = true;

    // 1) Visual state
    document.body.classList.add('gate-open');

    // 2) Flash
    if(flash){
      flash.classList.add('is-on');
      setTimeout(()=> flash.classList.remove('is-on'), 120);
    }

    // 3) IMMEDIATE view switch (no routing dependency)
    setActive('hall');

    // 4) History update (non-blocking)
    setTimeout(()=>{ location.hash = '#/hall'; }, 0);
  }

  // Use pointerup ONLY (most stable on mobile Chrome)
  gateDoor.addEventListener('pointerup', openGate);

  // Keyboard accessibility
  gateDoor.addEventListener('keydown', (e)=>{
    if(e.key==='Enter' || e.key===' ') { e.preventDefault(); openGate(); }
  });
})();

// Hall doors navigation
function bindRoute(el){
  const r = el.getAttribute('data-route');
  if(!r) return;
  const activate = ()=> goto(r);
  el.addEventListener('click', activate);
  el.addEventListener('keydown', (e)=>{
    if(e.key==='Enter' || e.key===' ') { e.preventDefault(); activate(); }
  });
}

document.querySelectorAll('[data-route]').forEach(bindRoute);

// Corridor behavior
backBtn?.addEventListener('click', ()=> history.back());
forwardBtn?.addEventListener('click', ()=> history.forward());

// Routing events
window.addEventListener('hashchange', onRouteChange);
window.addEventListener('popstate', onRouteChange);

// Init route (default to entrance)
if(!location.hash){
  location.hash = '#/';
}
setActive(routeFromHash());

// --- Minimal test cases (console) ---
function assert(cond, msg){
  if(!cond) throw new Error('Test failed: ' + msg);
}
(function runTests(){
  try{
    // Routing map
    assert(routeFromHash('#/') === 'entrance', 'routeFromHash entrance');
    assert(routeFromHash('#/hall') === 'hall', 'routeFromHash hall');
    assert(routeFromHash('#/info') === 'info', 'routeFromHash info');
    assert(routeFromHash('#/program') === 'program', 'routeFromHash program');
    assert(routeFromHash('#/perks') === 'perks', 'routeFromHash perks');
    assert(routeFromHash('#/faq') === 'faq', 'routeFromHash faq');

    // View mapping exists
    ['entrance','hall','info','program','perks','faq'].forEach(k=>{
      assert(!!views[k], 'view exists: ' + k);
    });

    // goto uses hash and should not throw
    const before = location.hash;
    goto('#/hall');
    assert(location.hash === '#/hall', 'goto updates hash');
    location.hash = before;

    console.log('[OK] routing tests passed');
  }catch(e){
    console.warn(e);
  }
})();
</script>

</body>
</html>
